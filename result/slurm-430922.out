Start Query_model job
Loading miniconda module and activate envs
===================================================================== Running python file ======================================================================
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/home/akoirala/Thesis/envs/lib/python3.9/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
args=Namespace(bs=8, n_epoch=3, lr=3e-05, model_dir='checkpoint', full=False, log=True, log_dir='mylog_prototype')
Starting 'Main program'
Starting 'Loading data'
Imported 499 rows of train datasset
Imported 499 rows of train datasset
Imported 49 rows of validation dataset
End 'Loading data' (in 0:00 mins)
Starting 'Training'
Starting 'Tokenizing (Train dataset)'
End 'Tokenizing (Train dataset)' (in 0:01 mins)
Starting 'Tokenizing (Val dataset)'
End 'Tokenizing (Val dataset)' (in 0:00 mins)
Starting 'Building dataset'
End 'Building dataset' (in 0:00 mins)
Starting 'Building dataloader'
End 'Building dataloader' (in 0:00 mins)
Device 0: NVIDIA A100-SXM4-40GB | Used: 1.83/40.00 GB
[Epoch 1] Training:   0%|          | 0/63 [00:00<?, ?it/s][Epoch 1] Training:   2%|▏         | 1/63 [00:16<16:55, 16.38s/it][Epoch 1] Training:   3%|▎         | 2/63 [00:16<06:59,  6.87s/it][Epoch 1] Training:   5%|▍         | 3/63 [00:16<03:49,  3.82s/it][Epoch 1] Training:   6%|▋         | 4/63 [00:16<02:20,  2.38s/it][Epoch 1] Training:   8%|▊         | 5/63 [00:17<01:32,  1.59s/it][Epoch 1] Training:  10%|▉         | 6/63 [00:17<01:03,  1.11s/it][Epoch 1] Training:  11%|█         | 7/63 [00:17<00:45,  1.23it/s][Epoch 1] Training:  13%|█▎        | 8/63 [00:17<00:33,  1.64it/s][Epoch 1] Training:  14%|█▍        | 9/63 [00:17<00:25,  2.09it/s][Epoch 1] Training:  16%|█▌        | 10/63 [00:18<00:20,  2.58it/s][Epoch 1] Training:  17%|█▋        | 11/63 [00:18<00:16,  3.07it/s][Epoch 1] Training:  19%|█▉        | 12/63 [00:18<00:14,  3.53it/s][Epoch 1] Training:  21%|██        | 13/63 [00:18<00:12,  3.95it/s][Epoch 1] Training:  22%|██▏       | 14/63 [00:18<00:11,  4.30it/s][Epoch 1] Training:  24%|██▍       | 15/63 [00:19<00:10,  4.58it/s][Epoch 1] Training:  25%|██▌       | 16/63 [00:19<00:09,  4.80it/s][Epoch 1] Training:  27%|██▋       | 17/63 [00:19<00:09,  4.96it/s][Epoch 1] Training:  29%|██▊       | 18/63 [00:19<00:08,  5.09it/s][Epoch 1] Training:  30%|███       | 19/63 [00:19<00:08,  5.18it/s][Epoch 1] Training:  32%|███▏      | 20/63 [00:19<00:08,  5.24it/s][Epoch 1] Training:  33%|███▎      | 21/63 [00:20<00:07,  5.29it/s][Epoch 1] Training:  35%|███▍      | 22/63 [00:20<00:07,  5.32it/s][Epoch 1] Training:  37%|███▋      | 23/63 [00:20<00:07,  5.34it/s][Epoch 1] Training:  38%|███▊      | 24/63 [00:20<00:07,  5.36it/s][Epoch 1] Training:  40%|███▉      | 25/63 [00:20<00:07,  5.37it/s][Epoch 1] Training:  41%|████▏     | 26/63 [00:21<00:06,  5.38it/s][Epoch 1] Training:  43%|████▎     | 27/63 [00:21<00:06,  5.38it/s][Epoch 1] Training:  44%|████▍     | 28/63 [00:21<00:06,  5.38it/s][Epoch 1] Training:  46%|████▌     | 29/63 [00:21<00:06,  5.38it/s][Epoch 1] Training:  48%|████▊     | 30/63 [00:21<00:06,  5.38it/s][Epoch 1] Training:  49%|████▉     | 31/63 [00:21<00:05,  5.39it/s][Epoch 1] Training:  51%|█████     | 32/63 [00:22<00:07,  4.29it/s][Epoch 1] Training:  52%|█████▏    | 33/63 [00:22<00:06,  4.56it/s][Epoch 1] Training:  54%|█████▍    | 34/63 [00:22<00:06,  4.78it/s][Epoch 1] Training:  56%|█████▌    | 35/63 [00:22<00:05,  4.95it/s][Epoch 1] Training:  57%|█████▋    | 36/63 [00:23<00:05,  5.08it/s][Epoch 1] Training:  59%|█████▊    | 37/63 [00:23<00:05,  5.17it/s][Epoch 1] Training:  60%|██████    | 38/63 [00:23<00:04,  5.24it/s][Epoch 1] Training:  62%|██████▏   | 39/63 [00:23<00:04,  5.29it/s][Epoch 1] Training:  63%|██████▎   | 40/63 [00:23<00:04,  5.32it/s][Epoch 1] Training:  65%|██████▌   | 41/63 [00:23<00:04,  5.34it/s][Epoch 1] Training:  67%|██████▋   | 42/63 [00:24<00:03,  5.36it/s][Epoch 1] Training:  68%|██████▊   | 43/63 [00:24<00:03,  5.37it/s][Epoch 1] Training:  70%|██████▉   | 44/63 [00:24<00:03,  5.38it/s][Epoch 1] Training:  71%|███████▏  | 45/63 [00:24<00:03,  5.39it/s][Epoch 1] Training:  73%|███████▎  | 46/63 [00:24<00:03,  5.39it/s][Epoch 1] Training:  75%|███████▍  | 47/63 [00:25<00:02,  5.39it/s][Epoch 1] Training:  76%|███████▌  | 48/63 [00:25<00:02,  5.39it/s][Epoch 1] Training:  78%|███████▊  | 49/63 [00:25<00:02,  5.40it/s][Epoch 1] Training:  79%|███████▉  | 50/63 [00:25<00:02,  5.40it/s][Epoch 1] Training:  81%|████████  | 51/63 [00:25<00:02,  5.40it/s][Epoch 1] Training:  83%|████████▎ | 52/63 [00:26<00:02,  5.40it/s][Epoch 1] Training:  84%|████████▍ | 53/63 [00:26<00:01,  5.39it/s][Epoch 1] Training:  86%|████████▌ | 54/63 [00:26<00:01,  5.39it/s][Epoch 1] Training:  87%|████████▋ | 55/63 [00:26<00:01,  5.39it/s][Epoch 1] Training:  89%|████████▉ | 56/63 [00:26<00:01,  5.39it/s][Epoch 1] Training:  90%|█████████ | 57/63 [00:26<00:01,  5.39it/s][Epoch 1] Training:  92%|█████████▏| 58/63 [00:27<00:00,  5.39it/s][Epoch 1] Training:  94%|█████████▎| 59/63 [00:27<00:00,  5.39it/s][Epoch 1] Training:  95%|█████████▌| 60/63 [00:27<00:00,  5.39it/s][Epoch 1] Training:  97%|█████████▋| 61/63 [00:27<00:00,  5.40it/s][Epoch 1] Training:  98%|█████████▊| 62/63 [00:27<00:00,  5.40it/s][Epoch 1] Training: 100%|██████████| 63/63 [00:27<00:00,  2.25it/s]
[Epoch 1] Trainning loss: 0.0284
[Epoch 1] Validating:   0%|          | 0/7 [00:00<?, ?it/s][Epoch 1] Validating:  29%|██▊       | 2/7 [00:00<00:00, 17.11it/s][Epoch 1] Validating:  57%|█████▋    | 4/7 [00:00<00:00, 17.12it/s][Epoch 1] Validating:  86%|████████▌ | 6/7 [00:00<00:00, 17.12it/s]/home/akoirala/Thesis/envs/lib/python3.9/site-packages/torch/nn/modules/loss.py:536: UserWarning: Using a target size (torch.Size([1])) that is different to the input size (torch.Size([])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
[Epoch 1] Validating: 100%|██████████| 7/7 [00:00<00:00, 17.10it/s]
[Epoch 1] New lowest val loss (0.0011)
Saved model to checkpoint/checkpoint-2
Saved train_losses to records/rec-1/train_losses.npy
Saved val_losses to records/rec-1/val_losses.npy
[Epoch 2] Training:   0%|          | 0/63 [00:00<?, ?it/s][Epoch 2] Training:   2%|▏         | 1/63 [00:00<00:11,  5.38it/s][Epoch 2] Training:   3%|▎         | 2/63 [00:00<00:11,  5.39it/s][Epoch 2] Training:   5%|▍         | 3/63 [00:00<00:11,  5.40it/s][Epoch 2] Training:   6%|▋         | 4/63 [00:00<00:10,  5.40it/s][Epoch 2] Training:   8%|▊         | 5/63 [00:00<00:10,  5.40it/s][Epoch 2] Training:  10%|▉         | 6/63 [00:01<00:10,  5.40it/s][Epoch 2] Training:  11%|█         | 7/63 [00:01<00:10,  5.40it/s][Epoch 2] Training:  13%|█▎        | 8/63 [00:01<00:10,  5.40it/s][Epoch 2] Training:  14%|█▍        | 9/63 [00:01<00:10,  5.40it/s][Epoch 2] Training:  16%|█▌        | 10/63 [00:01<00:09,  5.40it/s][Epoch 2] Training:  17%|█▋        | 11/63 [00:02<00:09,  5.40it/s][Epoch 2] Training:  19%|█▉        | 12/63 [00:02<00:09,  5.40it/s][Epoch 2] Training:  21%|██        | 13/63 [00:02<00:09,  5.40it/s][Epoch 2] Training:  22%|██▏       | 14/63 [00:02<00:09,  5.39it/s][Epoch 2] Training:  24%|██▍       | 15/63 [00:02<00:08,  5.38it/s][Epoch 2] Training:  25%|██▌       | 16/63 [00:02<00:08,  5.39it/s][Epoch 2] Training:  27%|██▋       | 17/63 [00:03<00:08,  5.39it/s][Epoch 2] Training:  29%|██▊       | 18/63 [00:03<00:08,  5.39it/s][Epoch 2] Training:  30%|███       | 19/63 [00:03<00:08,  5.39it/s][Epoch 2] Training:  32%|███▏      | 20/63 [00:03<00:07,  5.39it/s][Epoch 2] Training:  33%|███▎      | 21/63 [00:03<00:07,  5.39it/s][Epoch 2] Training:  35%|███▍      | 22/63 [00:04<00:07,  5.40it/s][Epoch 2] Training:  37%|███▋      | 23/63 [00:04<00:07,  5.40it/s][Epoch 2] Training:  38%|███▊      | 24/63 [00:04<00:07,  5.40it/s][Epoch 2] Training:  40%|███▉      | 25/63 [00:04<00:07,  5.40it/s][Epoch 2] Training:  41%|████▏     | 26/63 [00:04<00:06,  5.40it/s][Epoch 2] Training:  43%|████▎     | 27/63 [00:05<00:06,  5.40it/s][Epoch 2] Training:  44%|████▍     | 28/63 [00:05<00:06,  5.40it/s][Epoch 2] Training:  46%|████▌     | 29/63 [00:05<00:06,  5.40it/s][Epoch 2] Training:  48%|████▊     | 30/63 [00:05<00:06,  5.40it/s][Epoch 2] Training:  49%|████▉     | 31/63 [00:05<00:05,  5.40it/s][Epoch 2] Training:  51%|█████     | 32/63 [00:05<00:05,  5.40it/s][Epoch 2] Training:  52%|█████▏    | 33/63 [00:06<00:05,  5.40it/s][Epoch 2] Training:  54%|█████▍    | 34/63 [00:06<00:05,  5.40it/s][Epoch 2] Training:  56%|█████▌    | 35/63 [00:06<00:05,  5.40it/s][Epoch 2] Training:  57%|█████▋    | 36/63 [00:06<00:05,  5.40it/s][Epoch 2] Training:  59%|█████▊    | 37/63 [00:06<00:04,  5.40it/s][Epoch 2] Training:  60%|██████    | 38/63 [00:07<00:04,  5.40it/s][Epoch 2] Training:  62%|██████▏   | 39/63 [00:07<00:04,  5.40it/s][Epoch 2] Training:  63%|██████▎   | 40/63 [00:07<00:04,  5.40it/s][Epoch 2] Training:  65%|██████▌   | 41/63 [00:07<00:04,  5.40it/s][Epoch 2] Training:  67%|██████▋   | 42/63 [00:07<00:03,  5.40it/s][Epoch 2] Training:  68%|██████▊   | 43/63 [00:07<00:03,  5.40it/s][Epoch 2] Training:  70%|██████▉   | 44/63 [00:08<00:03,  5.40it/s][Epoch 2] Training:  71%|███████▏  | 45/63 [00:08<00:03,  5.40it/s][Epoch 2] Training:  73%|███████▎  | 46/63 [00:08<00:03,  5.39it/s][Epoch 2] Training:  75%|███████▍  | 47/63 [00:08<00:02,  5.39it/s][Epoch 2] Training:  76%|███████▌  | 48/63 [00:08<00:02,  5.38it/s][Epoch 2] Training:  78%|███████▊  | 49/63 [00:09<00:02,  5.39it/s][Epoch 2] Training:  79%|███████▉  | 50/63 [00:09<00:02,  5.39it/s][Epoch 2] Training:  81%|████████  | 51/63 [00:09<00:02,  5.39it/s][Epoch 2] Training:  83%|████████▎ | 52/63 [00:09<00:02,  5.40it/s][Epoch 2] Training:  84%|████████▍ | 53/63 [00:09<00:01,  5.40it/s][Epoch 2] Training:  86%|████████▌ | 54/63 [00:10<00:01,  5.40it/s][Epoch 2] Training:  87%|████████▋ | 55/63 [00:10<00:01,  5.40it/s][Epoch 2] Training:  89%|████████▉ | 56/63 [00:10<00:01,  5.40it/s][Epoch 2] Training:  90%|█████████ | 57/63 [00:10<00:01,  5.40it/s][Epoch 2] Training:  92%|█████████▏| 58/63 [00:10<00:00,  5.40it/s][Epoch 2] Training:  94%|█████████▎| 59/63 [00:10<00:00,  5.40it/s][Epoch 2] Training:  95%|█████████▌| 60/63 [00:11<00:00,  5.40it/s][Epoch 2] Training:  97%|█████████▋| 61/63 [00:11<00:00,  5.40it/s][Epoch 2] Training:  98%|█████████▊| 62/63 [00:11<00:00,  5.40it/s][Epoch 2] Training: 100%|██████████| 63/63 [00:11<00:00,  5.44it/s]
[Epoch 2] Trainning loss: 0.0073
[Epoch 2] Validating:   0%|          | 0/7 [00:00<?, ?it/s][Epoch 2] Validating:  29%|██▊       | 2/7 [00:00<00:00, 17.11it/s][Epoch 2] Validating:  57%|█████▋    | 4/7 [00:00<00:00, 17.12it/s][Epoch 2] Validating:  86%|████████▌ | 6/7 [00:00<00:00, 17.12it/s][Epoch 2] Validating: 100%|██████████| 7/7 [00:00<00:00, 19.43it/s]
[Epoch 2] Val loss = 0.0029 (Not reach new best)
Saved train_losses to records/rec-1/train_losses.npy
Saved val_losses to records/rec-1/val_losses.npy
[Epoch 3] Training:   0%|          | 0/63 [00:00<?, ?it/s][Epoch 3] Training:   2%|▏         | 1/63 [00:00<00:11,  5.40it/s][Epoch 3] Training:   3%|▎         | 2/63 [00:00<00:11,  5.39it/s][Epoch 3] Training:   5%|▍         | 3/63 [00:00<00:11,  5.38it/s][Epoch 3] Training:   6%|▋         | 4/63 [00:00<00:10,  5.39it/s][Epoch 3] Training:   8%|▊         | 5/63 [00:00<00:10,  5.39it/s][Epoch 3] Training:  10%|▉         | 6/63 [00:01<00:10,  5.38it/s][Epoch 3] Training:  11%|█         | 7/63 [00:01<00:10,  5.39it/s][Epoch 3] Training:  13%|█▎        | 8/63 [00:01<00:10,  5.39it/s][Epoch 3] Training:  14%|█▍        | 9/63 [00:01<00:10,  5.39it/s][Epoch 3] Training:  16%|█▌        | 10/63 [00:01<00:09,  5.39it/s][Epoch 3] Training:  17%|█▋        | 11/63 [00:02<00:09,  5.40it/s][Epoch 3] Training:  19%|█▉        | 12/63 [00:02<00:09,  5.40it/s][Epoch 3] Training:  21%|██        | 13/63 [00:02<00:09,  5.40it/s][Epoch 3] Training:  22%|██▏       | 14/63 [00:02<00:09,  5.40it/s][Epoch 3] Training:  24%|██▍       | 15/63 [00:02<00:08,  5.40it/s][Epoch 3] Training:  25%|██▌       | 16/63 [00:02<00:08,  5.40it/s][Epoch 3] Training:  27%|██▋       | 17/63 [00:03<00:08,  5.40it/s][Epoch 3] Training:  29%|██▊       | 18/63 [00:03<00:08,  5.40it/s][Epoch 3] Training:  30%|███       | 19/63 [00:03<00:08,  5.40it/s][Epoch 3] Training:  32%|███▏      | 20/63 [00:03<00:07,  5.40it/s][Epoch 3] Training:  33%|███▎      | 21/63 [00:03<00:07,  5.40it/s][Epoch 3] Training:  35%|███▍      | 22/63 [00:04<00:07,  5.40it/s][Epoch 3] Training:  37%|███▋      | 23/63 [00:04<00:07,  5.40it/s][Epoch 3] Training:  38%|███▊      | 24/63 [00:04<00:07,  5.40it/s][Epoch 3] Training:  40%|███▉      | 25/63 [00:04<00:07,  5.40it/s][Epoch 3] Training:  41%|████▏     | 26/63 [00:04<00:06,  5.40it/s][Epoch 3] Training:  43%|████▎     | 27/63 [00:05<00:06,  5.40it/s][Epoch 3] Training:  44%|████▍     | 28/63 [00:05<00:06,  5.40it/s][Epoch 3] Training:  46%|████▌     | 29/63 [00:05<00:06,  5.40it/s][Epoch 3] Training:  48%|████▊     | 30/63 [00:05<00:06,  5.40it/s][Epoch 3] Training:  49%|████▉     | 31/63 [00:05<00:05,  5.39it/s][Epoch 3] Training:  51%|█████     | 32/63 [00:05<00:05,  5.39it/s][Epoch 3] Training:  52%|█████▏    | 33/63 [00:06<00:05,  5.39it/s][Epoch 3] Training:  54%|█████▍    | 34/63 [00:06<00:05,  5.39it/s][Epoch 3] Training:  56%|█████▌    | 35/63 [00:06<00:05,  5.39it/s][Epoch 3] Training:  57%|█████▋    | 36/63 [00:06<00:05,  5.40it/s][Epoch 3] Training:  59%|█████▊    | 37/63 [00:06<00:04,  5.40it/s][Epoch 3] Training:  60%|██████    | 38/63 [00:07<00:04,  5.40it/s][Epoch 3] Training:  62%|██████▏   | 39/63 [00:07<00:04,  5.40it/s][Epoch 3] Training:  63%|██████▎   | 40/63 [00:07<00:04,  5.40it/s][Epoch 3] Training:  65%|██████▌   | 41/63 [00:07<00:04,  5.40it/s][Epoch 3] Training:  67%|██████▋   | 42/63 [00:07<00:03,  5.40it/s][Epoch 3] Training:  68%|██████▊   | 43/63 [00:07<00:03,  5.40it/s][Epoch 3] Training:  70%|██████▉   | 44/63 [00:08<00:03,  5.40it/s][Epoch 3] Training:  71%|███████▏  | 45/63 [00:08<00:03,  5.40it/s][Epoch 3] Training:  73%|███████▎  | 46/63 [00:08<00:03,  5.40it/s][Epoch 3] Training:  75%|███████▍  | 47/63 [00:08<00:02,  5.40it/s][Epoch 3] Training:  76%|███████▌  | 48/63 [00:08<00:02,  5.40it/s][Epoch 3] Training:  78%|███████▊  | 49/63 [00:09<00:02,  5.40it/s][Epoch 3] Training:  79%|███████▉  | 50/63 [00:09<00:02,  5.40it/s][Epoch 3] Training:  81%|████████  | 51/63 [00:09<00:02,  5.40it/s][Epoch 3] Training:  83%|████████▎ | 52/63 [00:09<00:02,  5.40it/s][Epoch 3] Training:  84%|████████▍ | 53/63 [00:09<00:01,  5.40it/s][Epoch 3] Training:  86%|████████▌ | 54/63 [00:10<00:01,  5.40it/s][Epoch 3] Training:  87%|████████▋ | 55/63 [00:10<00:01,  5.40it/s][Epoch 3] Training:  89%|████████▉ | 56/63 [00:10<00:01,  5.40it/s][Epoch 3] Training:  90%|█████████ | 57/63 [00:10<00:01,  5.39it/s][Epoch 3] Training:  92%|█████████▏| 58/63 [00:10<00:00,  5.39it/s][Epoch 3] Training:  94%|█████████▎| 59/63 [00:10<00:00,  5.39it/s][Epoch 3] Training:  95%|█████████▌| 60/63 [00:11<00:00,  5.39it/s][Epoch 3] Training:  97%|█████████▋| 61/63 [00:11<00:00,  5.39it/s][Epoch 3] Training:  98%|█████████▊| 62/63 [00:11<00:00,  5.39it/s][Epoch 3] Training: 100%|██████████| 63/63 [00:11<00:00,  5.44it/s]
[Epoch 3] Trainning loss: 0.0038
[Epoch 3] Validating:   0%|          | 0/7 [00:00<?, ?it/s][Epoch 3] Validating:  29%|██▊       | 2/7 [00:00<00:00, 17.11it/s][Epoch 3] Validating:  57%|█████▋    | 4/7 [00:00<00:00, 17.12it/s][Epoch 3] Validating:  86%|████████▌ | 6/7 [00:00<00:00, 17.12it/s][Epoch 3] Validating: 100%|██████████| 7/7 [00:00<00:00, 19.43it/s]
[Epoch 3] Val loss = 0.0012 (Not reach new best)
Saved train_losses to records/rec-1/train_losses.npy
Saved val_losses to records/rec-1/val_losses.npy
End 'Training' (in 1:21 mins)
End 'Main program' (in 1:21 mins)
===================================================================== Finished python file =====================================================================
